<div class="ngx-mat-input-tel-container">
  <button
    type="button"
    matRipple
    [matMenuTriggerFor]="menu"
    class="country-selector"
    [disabled]="disabled"
    (menuOpened)="menuSearchInput?.nativeElement?.focus()"
  >
    <span class="country-selector-flag flag" [ngClass]="selectedCountry.flagClass"></span>
    <span class="country-selector-code" *ngIf="selectedCountry?.dialCode"
      >+{{ selectedCountry.dialCode }}</span
    >
  </button>

  <mat-menu
    #menu="matMenu"
    class="ngx-mat-input-tel-mat-menu-panel"
    backdropClass="ngx-mat-input-tel-overlay-backdrop"
    overlayPanelClass="ngx-mat-input-tel-overlay-pane"
  >
    <input
      #menuSearchInput
      *ngIf="enableSearch"
      class="country-search"
      [(ngModel)]="searchCriteria"
      type="text"
      [placeholder]="searchPlaceholder"
      (click)="$event.stopPropagation()"
      style="
        width: 100%;
        height: 34px;
        border: none;
        border-bottom: 1px solid #ddd;
        font-size: 14px;
        padding: 20px 20px 24px;
        box-sizing: border-box;
      "
    />
    <button
      type="button"
      mat-menu-item
      class="country-list-button"
      *ngFor="let country of preferredCountriesInDropDown"
      (click)="onCountrySelect(country, focusable)"
    >
      <div class="icon-wrapper">
        <div class="flag" [ngClass]="country.flagClass"></div>
      </div>
      <div class="label-wrapper">
        {{ country.name }}
        <span *ngIf="country?.dialCode"
          >+{{ country.dialCode }}
          <ng-container *ngIf="country.areaCodes">
            {{ country.areaCodes.join(', ') }}
          </ng-container>
        </span>
      </div>
    </button>
    <mat-divider *ngIf="preferredCountriesInDropDown?.length"></mat-divider>
    <ng-container *ngFor="let country of allCountries">
      <button
        type="button"
        mat-menu-item
        class="country-list-button"
        *ngIf="country | search : searchCriteria"
        (click)="onCountrySelect(country, focusable)"
      >
        <div class="icon-wrapper">
          <div class="flag" [ngClass]="country.flagClass"></div>
        </div>
        <div class="label-wrapper">
          {{ country.name }} +{{ country.dialCode }}
          <ng-container *ngIf="country.areaCodes">
            {{ country.areaCodes.join(', ') }}
          </ng-container>
        </div>
      </button>
    </ng-container>
  </mat-menu>

  <input
    matInput
    type="tel"
    inputmode="tel"
    [autocomplete]="autocomplete"
    [ngClass]="cssClass"
    (blur)="onTouched()"
    (keypress)="onInputKeyPress($event)"
    [(ngModel)]="phoneNumber"
    (ngModelChange)="onPhoneNumberChange()"
    [errorStateMatcher]="errorStateMatcher"
    [placeholder]="inputPlaceholder"
    [disabled]="disabled"
    #focusable
  />
</div>
